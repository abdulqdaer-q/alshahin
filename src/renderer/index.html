<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'">
  <title>Web Apps Menubar</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Header with Controls -->
  <header class="header">
    <!-- Navigation Controls -->
    <div class="nav-controls">
      <button id="btn-back" class="nav-btn" title="Back" disabled>
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      <button id="btn-forward" class="nav-btn" title="Forward" disabled>
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      <button id="btn-reload" class="nav-btn" title="Reload">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M14 8C14 11.3137 11.3137 14 8 14C4.68629 14 2 11.3137 2 8C2 4.68629 4.68629 2 8 2C10.3456 2 12.3999 3.24924 13.4854 5.11111" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          <path d="M11 2L13.5 5L10.5 6.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>

      <!-- User Agent Toggle -->
      <div class="ua-toggle">
        <button id="btn-ua-desktop" class="ua-btn active" title="Desktop Mode">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <rect x="2" y="3" width="12" height="8" rx="1" stroke="currentColor" stroke-width="1.5"/>
            <path d="M6 13H10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <path d="M8 11V13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </button>
        <button id="btn-ua-mobile" class="ua-btn" title="Mobile Mode">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <rect x="5" y="2" width="6" height="12" rx="1" stroke="currentColor" stroke-width="1.5"/>
            <circle cx="8" cy="12" r="0.5" fill="currentColor"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Address Bar -->
    <div class="address-bar">
      <span id="address-url" class="address-url" title="">No site loaded</span>
      <div id="loading-spinner" class="loading-spinner hidden"></div>
    </div>

    <!-- Action Buttons -->
    <div class="action-controls">
      <button id="btn-always-on-top" class="action-btn" title="Toggle Always on Top">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M8 3L11 6L9 6L9 11L7 11L7 6L5 6L8 3Z" fill="currentColor"/>
          <path d="M3 13H13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
      <button id="btn-adblock" class="action-btn" title="Toggle Ad Blocker">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M8 2L13 4V8C13 11 8 14 8 14C8 14 3 11 3 8V4L8 2Z" stroke="currentColor" stroke-width="1.5" fill="none"/>
          <path d="M5.5 8L7 9.5L10.5 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      <button id="btn-add-site" class="action-btn" title="Add Site">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M8 3V13M3 8H13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
      <button id="btn-settings" class="action-btn" title="Settings">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.5"/>
          <path d="M8 1V3M8 13V15M15 8H13M3 8H1M12.5 3.5L11 5M5 11L3.5 12.5M12.5 12.5L11 11M5 5L3.5 3.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
      </button>
    </div>
  </header>

  <!-- Sites Tabs -->
  <div id="sites-tabs" class="sites-tabs">
    <!-- Tabs will be inserted here dynamically -->
  </div>

  <!-- Main Content Area (BrowserView renders below this in main process) -->
  <div id="empty-state" class="empty-state">
    <svg width="64" height="64" viewBox="0 0 64 64" fill="none" class="empty-icon">
      <rect x="8" y="16" width="48" height="32" rx="2" stroke="currentColor" stroke-width="2"/>
      <path d="M8 24H56" stroke="currentColor" stroke-width="2"/>
      <circle cx="14" cy="20" r="1.5" fill="currentColor"/>
      <circle cx="20" cy="20" r="1.5" fill="currentColor"/>
      <circle cx="26" cy="20" r="1.5" fill="currentColor"/>
    </svg>
    <h3>No Sites Added</h3>
    <p>Click the + button to add your first web app</p>
  </div>

  <!-- Modals -->

  <!-- Add/Edit Site Modal -->
  <div id="modal-site" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modal-site-title">Add Site</h2>
        <button class="modal-close" id="modal-site-close">&times;</button>
      </div>
      <form id="form-site" class="modal-body">
        <input type="hidden" id="site-id" />

        <div class="form-group">
          <label for="site-name">Name *</label>
          <input type="text" id="site-name" placeholder="My Web App" required />
        </div>

        <div class="form-group">
          <label for="site-url">URL *</label>
          <input type="url" id="site-url" placeholder="https://example.com" required />
        </div>

        <div class="form-group">
          <label for="site-icon">Icon (optional)</label>
          <input type="text" id="site-icon" placeholder="https://example.com/icon.png or base64" />
          <small>Enter a URL or base64-encoded image</small>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" id="btn-site-cancel">Cancel</button>
          <button type="submit" class="btn btn-primary" id="btn-site-save">Save</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Import/Export Modal -->
  <div id="modal-import-export" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Import / Export Sites</h2>
        <button class="modal-close" id="modal-ie-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="ie-section">
          <h3>Export</h3>
          <p>Save your sites and settings to a JSON file</p>
          <button type="button" class="btn btn-primary" id="btn-export">Export to File</button>
        </div>

        <div class="ie-divider"></div>

        <div class="ie-section">
          <h3>Import</h3>
          <p>Load sites from a JSON file</p>
          <div class="import-options">
            <label>
              <input type="radio" name="import-mode" value="replace" checked />
              Replace all sites
            </label>
            <label>
              <input type="radio" name="import-mode" value="merge" />
              Merge with existing sites
            </label>
          </div>
          <button type="button" class="btn btn-primary" id="btn-import">Import from File</button>
        </div>

        <div class="ie-divider"></div>

        <div class="ie-section">
          <h3>Storage Location</h3>
          <p id="storage-path" class="storage-path">Loading...</p>
          <small>Sites are automatically saved to this file</small>
        </div>
      </div>
    </div>
  </div>

  <!-- Site Context Menu (for edit/delete/pin/etc) -->
  <div id="context-menu" class="context-menu hidden">
    <div class="context-menu-item" id="ctx-pin">Pin Site</div>
    <div class="context-menu-item" id="ctx-edit">Edit Site</div>
    <div class="context-menu-item" id="ctx-open-browser">Open in Browser</div>
    <div class="context-menu-divider"></div>
    <div class="context-menu-item ctx-danger" id="ctx-delete">Delete Site</div>
  </div>

  <!-- Settings Modal -->
  <div id="modal-settings" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Settings</h2>
        <button class="modal-close" id="modal-settings-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="settings-section">
          <h3>Window Settings</h3>
          <label class="checkbox-label">
            <input type="checkbox" id="settings-popover-always-on-top" />
            <span>Keep popover window always on top</span>
          </label>
        </div>

        <div class="settings-divider"></div>

        <div class="settings-section">
          <h3>Privacy & Security</h3>
          <label class="checkbox-label">
            <input type="checkbox" id="settings-adblock" />
            <span>Enable ad-blocking (blocks common ad domains)</span>
          </label>
          <small class="settings-help">Uses a built-in filter list to block ads and trackers</small>
        </div>

        <div class="settings-divider"></div>

        <div class="settings-section">
          <h3>Keyboard Shortcuts</h3>
          <div class="shortcut-list">
            <div class="shortcut-item">
              <span class="shortcut-key">Ctrl/Cmd + Shift + X</span>
              <span class="shortcut-desc">Toggle popover window</span>
            </div>
            <div class="shortcut-item">
              <span class="shortcut-key">Ctrl/Cmd + Tab</span>
              <span class="shortcut-desc">Cycle through sites</span>
            </div>
            <div class="shortcut-item">
              <span class="shortcut-key">Ctrl/Cmd + Alt + I</span>
              <span class="shortcut-desc">Open DevTools</span>
            </div>
          </div>
        </div>

        <div class="settings-divider"></div>

        <div class="settings-section">
          <h3>Storage Location</h3>
          <p id="settings-storage-path" class="storage-path">Loading...</p>
          <small>Sites and settings are automatically saved to this location</small>
        </div>

        <div class="settings-divider"></div>

        <div class="settings-section">
          <h3>Import / Export</h3>
          <p>Backup or restore your sites and settings</p>
          <button type="button" class="btn btn-secondary" id="settings-btn-import-export">Open Import/Export</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Polyfill for CommonJS exports in browser context
    window.exports = {};
    window.module = { exports: {} };
  </script>
  <script src="renderer.js"></script>
</body>
</html>
